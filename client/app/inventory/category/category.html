
<div class="container">
<div class="row">
  <H4>Categories</H4>
</div>




<div class="col-md-6">
  <div class="panel panel-default">
    <div class="panel-heading"> <h3 class="panel-title">Edit Category</h3></div>
    <div class="panel-body">

      <form class="form" name="form" ng-submit="addCategory(form)" novalidate autocomplete="off">

        <tabset>
          <tab heading="General">
            <!--Title-->
            <div class="form-group " ng-class="{ 'has-success': form.name.$valid && submitted,
                                                'has-error': form.name.$invalid && submitted }">
              <label popover-placement="top"
                     popover="Category name visible to clients"
                     popover-trigger="mouseenter">
                     Title
              </label>
              <input  type="text" name="title" class="form-control" ng-model="category.name"required/>
              <p class="help-block" ng-show="form.title.$error.required && submitted">
                A title is required
              </p>
            </div>
            <!--Slug-->
            <div class="form-group" ng-class="{ 'has-success': form.slug.$valid && submitted,
                                                'has-error': form.slug.$invalid && submitted }">
              <label   popover-placement="top"
                      popover="Unique identifier"
                      popover-trigger="mouseenter">
                      Slug
              </label>
              <input type="text" name="slug" class="form-control" ng-model="category.slug"
                     required
                     mongoose-error/>
              <p class="help-block" ng-show="form.slug.$error.email && submitted">
                Doesn't look like a valid name.
              </p>
              <p class="help-block" ng-show="form.slug.$error.required && submitted">
                Slug is required.
              </p>
              <p class="help-block" ng-show="form.slug.$error.mongoose">
                {{ errors.slug }}
              </p>
            </div>
            <!--Parent-->
            <div class="form-group" ng-class="{ 'has-success': form.parent.$valid && submitted,
                                                'has-error': form.parent.$invalid && submitted }">
              <label  popover-placement="top"
                      popover="Parent category. Leave blank for main category."
                      popover-trigger="mouseenter">
                      Parent
              </label>
              <select class="form-control"
                      ng-options="cat._id as cat.name + ': ' + cat.description  for cat in categories"
                      style="widht:70%;"
                      ng-model="category.parent"

          						default="null"
                      name="parent">
              </select>
          </div>
            <!--Description-->
            <div class="form-group" ng-class="{ 'has-success': form.description.$valid && submitted,
                                                'has-error': form.description.$invalid && submitted }">
              <label>Descrription</label>
              <textarea name="description" class="form-control" ng-model="category.description"
                     required
                     mongoose-error/>
              <p class="help-block" ng-show="form.description.$error.required && submitted">
                Please provide a description for the category.
              </p>
            </div>


          </tab>
          <tab heading="Images">
            <span class="btn btn-default btn-file">
    Browse! <input type="file" files-model="img.files" files-callback="test()" multiple  >
</span>
<p ng-repeat="img in seletedImages">a <pre>{{img.name | json }}</pre></p>
<!--
            <div flow-init="{target: '/api/images'}"
                 flow-files-submitted="$flow.upload()"
                 flow-file-success="$file.msg = $message">
              <input type="file" flow-btn />
              <span class="btn" flow-btn>Upload File</span>
              <button class="btn btn-md btn-success" ng-click="uploadImages($flow)">
                Upload
              </button>

              <div class="jumbotron" flow-drop
                    flow-drag-enter="class='alert-success'" flow-drag-leave="class=''"
                  ng-class="class" >
                <span class="title">Drag and drop your files here!</span>
                <img ng-repeat="img in $flow.files" flow-img="img" style="box-shadow: 5px 5px 2px #888888;margin:5px;height:90px;width:auto;"/>


            </div>
          </div>-->
          </tab>
        </tabset>

  <hr>
        <div>
          <button class="btn btn-md btn-success" type="submit">
            Submit
          </button>
          <a class="btn btn-default btn-md btn-register" ng-click="reset(form)" type="reset">
            Clear
          </a>
      		<alert ng-show="alert.msg" type="{{alert.type}}" >{{alert.msg}}</alert>
        </div>

      </form>
    </div>

</div>
</div>


<div class="col-md-6">

<!--
<a1 class="pull-right btn " href="/category/new"><span class="glyphicon glyphicon-plus"></span> Create Category</a>
-->
<div class="panel panel-default">
  <div class="panel-heading"> <h3 class="panel-title">Your Shop</h3></div>

  <script type="text/ng-template" id="categoryTree">
      <a ng-click="selectCategory(cat)" href="#">{{ cat.name }}</a>
  		<a href="" ng-click="deleteCategory(cat)">	<span class="glyphicon glyphicon-remove"></span>	</a>
      <ul ng-if="cat.children.length>0">
          <li ng-repeat="cat in cat.children" ng-include="'categoryTree'">
          </li>
      </ul>
  </script>

  <ul class="list-group">
  	<li class="list-group-item" ng-repeat="cat in tree">
  		<a ng-click="selectCategory(cat)" href="#">{{ cat.name}}</a>
  	<a href="" ng-click="deleteCategory(cat)">	<span class="glyphicon glyphicon-remove"></span>	</a>
  	<ul>
      <li ng-repeat="cat in cat.children" ng-include="'categoryTree'"></li>
  	</ul>
  	</li>
  </ul>
  </div>







</div>

</div>
